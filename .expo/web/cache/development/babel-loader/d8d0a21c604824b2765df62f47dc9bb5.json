{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/raj/Desktop/skrt/src/pages/Payment.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { setStatusBarNetworkActivityIndicatorVisible, StatusBar } from 'expo-status-bar';\nimport React, { useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport CreditCard from 'react-native-credit-card-form-ui';\nimport Carousel from 'react-native-snap-carousel';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { get } from 'react-native/Libraries/Utilities/PixelRatio';\nimport { useFocusEffect } from '@react-navigation/native';\nvar SLIDER_WIDTH = Dimensions.get('window').width;\nvar ITEM_WIDTH = Math.round(SLIDER_WIDTH * 0.7);\nvar ITEM_HEIGHT = Math.round(ITEM_WIDTH * 3 / 4);\n\nvar ScreenContainer = function ScreenContainer(_ref) {\n  var children = _ref.children;\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 5\n    }\n  }, children);\n};\n\nvar storeData = function storeData(value) {\n  var jsonValue;\n  return _regeneratorRuntime.async(function storeData$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          jsonValue = JSON.stringify(value);\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@card_key', jsonValue));\n\n        case 4:\n          _context.next = 9;\n          break;\n\n        case 6:\n          _context.prev = 6;\n          _context.t0 = _context[\"catch\"](0);\n          console.log(\"saving error\");\n\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[0, 6]], Promise);\n};\n\nvar storeCard = function storeCard(index, value) {\n  var jsonValue;\n  return _regeneratorRuntime.async(function storeCard$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          jsonValue = JSON.stringify(value);\n          _context2.next = 4;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@current_card', jsonValue));\n\n        case 4:\n          _context2.next = 6;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@current_card_index', index.toString()));\n\n        case 6:\n          _context2.next = 11;\n          break;\n\n        case 8:\n          _context2.prev = 8;\n          _context2.t0 = _context2[\"catch\"](0);\n          console.log(\"saving error\");\n\n        case 11:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[0, 8]], Promise);\n};\n\nvar getData = function getData() {\n  var jsonValue;\n  return _regeneratorRuntime.async(function getData$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem('@card_key'));\n\n        case 3:\n          jsonValue = _context3.sent;\n          return _context3.abrupt(\"return\", jsonValue != null ? JSON.parse(jsonValue) : null);\n\n        case 7:\n          _context3.prev = 7;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.log(\"error reading\");\n\n        case 10:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, [[0, 7]], Promise);\n};\n\nvar getCardIndex = function getCardIndex() {\n  var index;\n  return _regeneratorRuntime.async(function getCardIndex$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          _context4.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem('@current_card_index'));\n\n        case 3:\n          index = _context4.sent;\n          return _context4.abrupt(\"return\", index != null ? index : null);\n\n        case 7:\n          _context4.prev = 7;\n          _context4.t0 = _context4[\"catch\"](0);\n          console.log(\"error reading\");\n\n        case 10:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, [[0, 7]], Promise);\n};\n\nexport var Payment = function Payment(_ref2) {\n  var navigation = _ref2.navigation;\n\n  var _useState = useState({\n    activeIndex: 0,\n    carouselItems: []\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var creditCardRef = React.useRef();\n  var handleSubmit = React.useCallback(function () {\n    Keyboard.dismiss();\n\n    if (creditCardRef.current) {\n      var _creditCardRef$curren = creditCardRef.current.submit(),\n          error = _creditCardRef$curren.error,\n          data = _creditCardRef$curren.data;\n\n      var CCnumber = data.number.slice(data.number.length - 4);\n      var cardType = \"\";\n\n      if (data.brand == \"visa\") {\n        cardType = \"https://i.imgur.com/deGaUxh.png\";\n      }\n\n      if (data.brand == \"american-express\") {\n        cardType = \"https://i.imgur.com/JWqsQan.png\";\n      }\n\n      if (data.brand == \"mastercard\") {\n        cardType = \"https://i.imgur.com/5oUkgLB.png\";\n      }\n\n      var userData = {\n        title: CCnumber,\n        text: data.holder,\n        imgUrl: cardType,\n        brand: data.brand,\n        fullNumber: data.number,\n        cvv: data.cvv,\n        expiration: data.expiration,\n        holder: data.holder\n      };\n      var prevState = state.carouselItems;\n      prevState.push(userData);\n      setState({\n        carouselItems: prevState\n      });\n      storeData(state.carouselItems);\n\n      if (state.carouselItems.length == 1) {\n        saveSelectedCard(0);\n      }\n    }\n  }, []);\n\n  var _renderItem = function _renderItem(_ref3) {\n    var item = _ref3.item,\n        index = _ref3.index;\n    return React.createElement(View, {\n      style: styles.chaka,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }\n    }, React.createElement(Image, {\n      source: {\n        uri: item.imgUrl\n      },\n      style: styles.image,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 11\n      }\n    }), React.createElement(Text, {\n      style: {\n        fontSize: 30\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 13\n      }\n    }, item.title), React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 13\n      }\n    }, item.text));\n  };\n\n  var saveSelectedCard = function saveSelectedCard(slideIndex) {\n    console.log(state.carouselItems[slideIndex]);\n    storeCard(slideIndex, state.carouselItems[slideIndex]);\n  };\n\n  useFocusEffect(React.useCallback(function () {\n    console.log(\"focused\");\n\n    function updateList() {\n      var _this2 = this;\n\n      var fetched_carousel_items, currIndex;\n      return _regeneratorRuntime.async(function updateList$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(getData());\n\n            case 2:\n              fetched_carousel_items = _context5.sent;\n              _context5.next = 5;\n              return _regeneratorRuntime.awrap(getCardIndex());\n\n            case 5:\n              currIndex = _context5.sent;\n              console.log(\"before snap: saved index \", currIndex, \"current Index \", this.carousel.currentIndex);\n              setState({\n                carouselItems: fetched_carousel_items\n              });\n              setTimeout(function () {\n                return _this2.carousel.snapToItem(currIndex, animated = false, fireCallback = false);\n              }, 250);\n              console.log(\"after snap: saved index \", currIndex, \"current Index \", this.carousel.currentIndex);\n              Keyboard.dismiss();\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n\n    updateList();\n  }, []));\n  return React.createElement(ScreenContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.OS === 'ios' ? 'padding' : 'height',\n    keyboardVerticalOffset: 20,\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }\n  }, React.createElement(CreditCard, {\n    ref: creditCardRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 15\n    }\n  }), React.createElement(Button, {\n    title: \"Add Card\",\n    onPress: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  })), React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: 'column',\n      justifyContent: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 11\n    }\n  }, React.createElement(Carousel, {\n    layout: \"default\",\n    layoutCardOffset: 18,\n    ref: function ref(_ref4) {\n      return _this.carousel = _ref4;\n    },\n    data: state.carouselItems,\n    renderItem: _renderItem,\n    sliderWidth: SLIDER_WIDTH,\n    itemWidth: ITEM_WIDTH,\n    onSnapToItem: saveSelectedCard,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  })));\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  chaka: {\n    width: ITEM_WIDTH,\n    height: ITEM_HEIGHT,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'white'\n  },\n  image: {\n    width: ITEM_WIDTH,\n    height: ITEM_HEIGHT / 1.36,\n    resizeMode: 'contain'\n  }\n});","map":{"version":3,"sources":["/Users/raj/Desktop/skrt/src/pages/Payment.js"],"names":["setStatusBarNetworkActivityIndicatorVisible","StatusBar","React","useState","CreditCard","Carousel","AsyncStorage","get","useFocusEffect","SLIDER_WIDTH","Dimensions","width","ITEM_WIDTH","Math","round","ITEM_HEIGHT","ScreenContainer","children","styles","container","storeData","value","jsonValue","JSON","stringify","setItem","console","log","storeCard","index","toString","getData","getItem","parse","getCardIndex","Payment","navigation","activeIndex","carouselItems","state","setState","creditCardRef","useRef","handleSubmit","useCallback","Keyboard","dismiss","current","submit","error","data","CCnumber","number","slice","length","cardType","brand","userData","title","text","holder","imgUrl","fullNumber","cvv","expiration","prevState","push","saveSelectedCard","_renderItem","item","chaka","uri","image","fontSize","slideIndex","updateList","fetched_carousel_items","currIndex","carousel","currentIndex","setTimeout","snapToItem","animated","fireCallback","Platform","OS","flex","flexDirection","justifyContent","ref","StyleSheet","create","backgroundColor","alignItems","height","resizeMode"],"mappings":"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","sourcesContent":["import { setStatusBarNetworkActivityIndicatorVisible, StatusBar } from 'expo-status-bar';\nimport React, { useState } from 'react';\nimport {\n  StyleSheet,\n  Text,\n  View,\n  Image,\n  TextInput,\n  Button,\n  TouchableOpacity,\n  ScrollView, \n  Platform,\n  KeyboardAvoidingView,\n  Dimensions,\n  Keyboard\n} from \"react-native\";\nimport CreditCard from 'react-native-credit-card-form-ui';\nimport Carousel from 'react-native-snap-carousel';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { get } from 'react-native/Libraries/Utilities/PixelRatio';\nimport { useFocusEffect } from '@react-navigation/native';\n\nconst SLIDER_WIDTH = Dimensions.get('window').width;\nconst ITEM_WIDTH = Math.round(SLIDER_WIDTH * 0.7);\nconst ITEM_HEIGHT = Math.round(ITEM_WIDTH * 3 / 4);\n  \nconst ScreenContainer = ({ children }) => (\n    <View style = {styles.container}>{children}</View>\n  )\n\n\n\n  const storeData = async (value) => {\n    try {\n      const jsonValue = JSON.stringify(value)\n      await AsyncStorage.setItem('@card_key', jsonValue)\n    } catch (e) {\n      // saving error\n      console.log(\"saving error\")\n    }\n  }\n\n  const storeCard = async (index, value) => {\n    try {\n      const jsonValue = JSON.stringify(value)\n      await AsyncStorage.setItem('@current_card', jsonValue)\n      await AsyncStorage.setItem('@current_card_index', index.toString())\n    } catch (e) {\n      // saving error\n      console.log(\"saving error\")\n    }\n  }\n\n  const getData = async () => {\n    try {\n      const jsonValue = await AsyncStorage.getItem('@card_key')\n      return jsonValue != null ? JSON.parse(jsonValue) : null;\n    } catch(e) {\n      // error reading value\n      console.log(\"error reading\")\n    }\n  }\n\n  const getCardIndex = async () => {\n    try {\n      const index = await AsyncStorage.getItem('@current_card_index')\n      return index != null ? index : null; \n    } catch (e) {\n      console.log(\"error reading\")\n    }\n  }\n\n\n  \n\nexport const Payment = ({ navigation }) => {\n  \n      var [state, setState] = useState({\n      activeIndex:0,\n      carouselItems: [\n      // {\n      //     title:\"Item 1\",\n      //     text: \"Text 1\",\n      //     imgUrl: \"https://i.imgur.com/5oUkgLB.png\",\n      // },\n      // {\n      //     title:\"348592937859236\",\n      //     text: \"Ronaldo Gomez\",\n      //     imgUrl:\"https://i.imgur.com/JWqsQan.png\",\n          \n      // },\n      // {\n      //     title:\"Item 3\",\n      //     text: \"Text 3\",\n      //     imgUrl:\"https://i.imgur.com/deGaUxh.png\",\n          \n      // },\n      // {\n      //     title:\"Item 4\",\n      //     text: \"Text 4\",\n      //     imgUrl:\"https://i.imgur.com/mUVxJha.png\",\n          \n      // },\n      // {\n      //     title:\"Item 5\",\n      //     text: \"Text 5\",\n      //     imgUrl:\"\",\n          \n      // },\n    ]\n   })\n  \n  const creditCardRef = React.useRef();\n\n  const handleSubmit = React.useCallback(() => {\n    Keyboard.dismiss()\n    if (creditCardRef.current) {\n      const { error, data } = creditCardRef.current.submit();\n      var CCnumber = data.number.slice(data.number.length - 4);\n      var cardType = \"\"\n      if (data.brand == \"visa\") {\n        cardType = \"https://i.imgur.com/deGaUxh.png\"\n      }\n      if (data.brand == \"american-express\") {\n        cardType = \"https://i.imgur.com/JWqsQan.png\"\n      }\n      if (data.brand == \"mastercard\") {\n        cardType = \"https://i.imgur.com/5oUkgLB.png\"\n      }\n      \n      var userData = {\n        title: CCnumber,\n        text: data.holder,\n        imgUrl: cardType,\n\n        brand: data.brand,\n        fullNumber: data.number,\n        cvv: data.cvv,\n        expiration: data.expiration,\n        holder: data.holder, \n      }\n      var prevState = state.carouselItems;\n      prevState.push(userData)\n      setState({carouselItems: prevState})\n      storeData(state.carouselItems)\n\n      if(state.carouselItems.length == 1) {\n        saveSelectedCard(0)\n      }\n      \n    }\n  }, []);\n\n  const _renderItem = ({item, index}) => {\n    return (\n        <View style={styles.chaka}>\n          <Image source={{uri: item.imgUrl}} style = {styles.image} />\n            <Text style={{fontSize: 30}}>{ item.title }</Text>\n            <Text>{item.text}</Text>\n        </View>\n    );\n  }\n\n  const saveSelectedCard = (slideIndex) => {\n    console.log(state.carouselItems[slideIndex])\n    storeCard(slideIndex, state.carouselItems[slideIndex])\n  }\n  \n  useFocusEffect(\n    React.useCallback(() =>  {\n\n      console.log(\"focused\")\n      async function updateList(){\n\n        const fetched_carousel_items = await getData();\n        const currIndex = await getCardIndex();\n        console.log(\"before snap: saved index \", currIndex, \"current Index \", this.carousel.currentIndex)\n        setState({carouselItems: fetched_carousel_items})\n        setTimeout(() => this.carousel.snapToItem(currIndex, animated=false, fireCallback=false), 250)\n        //this.carousel.snapToItem(currIndex, animated=false, fireCallback=true)\n        console.log(\"after snap: saved index \", currIndex, \"current Index \", this.carousel.currentIndex)\n        Keyboard.dismiss()\n      }\n      updateList();\n    }, [])\n  );\n\n    return (\n      \n      <ScreenContainer>\n          <KeyboardAvoidingView\n              behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n              keyboardVerticalOffset={20}\n              style={styles.container}\n              >\n              <CreditCard ref={creditCardRef} />\n              <Button title=\"Add Card\" onPress={handleSubmit} />\n          </KeyboardAvoidingView>\n          <View style={{ flex: 1, flexDirection:'column', justifyContent: 'center'}}>\n          <Carousel\n            layout={\"default\"} layoutCardOffset={18}\n            ref={ref => this.carousel = ref}\n            data={state.carouselItems}\n            renderItem={_renderItem}\n            sliderWidth={SLIDER_WIDTH}\n            itemWidth={ITEM_WIDTH}\n            onSnapToItem={saveSelectedCard}\n          />\n          </View>\n      </ScreenContainer>\n      \n    );\n    \n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  chaka: {\n    width: ITEM_WIDTH,\n    height: ITEM_HEIGHT,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'white'\n  },\n  image: {\n    width: ITEM_WIDTH,\n    height: ITEM_HEIGHT/1.36,\n    resizeMode: 'contain'\n  },\n});"]},"metadata":{},"sourceType":"module"}